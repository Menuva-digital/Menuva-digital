<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reservasi Room</title>
<style>
  /* ===================== RESET & THEME ===================== */
  * { box-sizing: border-box; margin:0; padding:0; }
  :root {
    --bg: #eaf1ff;          /* biru lembut */
    --surface: #ffffff;
    --text: #1f2a44;
    --muted: #5c6b8a;
    --border: #c2d4ff;
    --primary: #1f70ff;      /* biru elegan */
    --success: #25d366;
    --card-light: #ffffff;
    --card-dark: #1c2333;
    --shadow: 0 6px 24px rgba(0,0,0,.08);
  }
  body.dark {
    --bg: #0e1116;
    --surface: #141922;
    --text: #e6ebff;
    --muted: #aab6db;
    --border: #263148;
    --primary: #4da3ff;
    --chip: #0f1a2a;
    --shadow: 0 8px 28px rgba(0,0,0,.5);
  }

  body {
    font-family: system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
    transition: background .3s, color .3s;
    padding-bottom: 80px; /* biar fixed bar ga nutup konten */
  }

  /* ===================== HEADER ===================== */
  header .header-inner {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 20px;
  }
  header img#restoLogo {
    width: 60px;
    height: 60px;
    object-fit: contain;
    border-radius: 8px;
  }
  header h1 { font-size: 1.2rem; }
  header .contact-info { font-size: 0.8rem; color: var(--muted); }

  /* ===================== MAIN CONTAINER ===================== */
  .main-container {
    width: 95%;
    max-width: 900px;
    margin: 20px auto;
    background: var(--card-light);
    border-radius: 10px;
    padding: 16px;
    box-shadow: var(--shadow);
    transition: background .3s, color .3s;
  }
  body.dark .main-container { background: var(--card-dark); }

  /* ===================== TABS ===================== */
  .tabs {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* selalu 3 sejajar */
    gap: 10px;
    margin-bottom: 16px;
  }
  .tabs button {
    width: 100%;
    padding: 6px 14px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: #eee;
    font-size: 0.9rem;
    transition: background .3s;
  }
  .tabs button.active { background: var(--primary); color: #fff; }
  body.dark .tabs button { background: #2a2f3d; color: #ddd; }
  body.dark .tabs button.active { background: var(--primary); color: #fff; }

  /* ===================== GRID ===================== */
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(140px,1fr));
    gap: 12px;
  }
  .hidden { display: none; }

  /* ===================== ROOM CARD ===================== */
  .room-card {
    background: var(--card-light);
    border-radius: 10px;
    padding: 10px;
    text-align: center;
    font-size: 0.85rem;
    border: 1px solid #ddd;
    transition: background .3s, color .3s;
  }
  body.dark .room-card { background: var(--card-dark); border-color: #444; }
  .room-card img { width: 100%; height: 100px; object-fit: cover; border-radius: 6px; margin-bottom: 6px; }
  .room-card h3 { font-size: 0.95rem; margin: 4px 0; }
  .room-card p { margin: 2px 0; font-size: 0.8rem; }
  .room-card button {
    margin-top: 6px;
    padding: 6px 10px;
    font-size: 0.8rem;
    background: var(--success);
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }

  /* ===================== RESERVASI FORM ===================== */
  .reservasi-container { margin-top: 20px; }
  #cartPreview { background: var(--chip); padding: 10px; border-radius: 8px; margin-bottom: 8px; font-size: 0.85rem; }
  .cart-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; gap: 4px; flex-wrap: wrap; }

  .form-input {
    display: flex;
    flex-direction: column;
    margin-bottom: 10px;
  }
  .form-input label { font-size: 0.85rem; margin-bottom: 4px; }
  .form-input input,
  .form-input textarea {
    padding: 6px 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 0.85rem;
    width: 100%;
  }
  .form-input textarea { resize: vertical; min-height: 60px; }

  /* ===================== FIXED BAR ===================== */
  .fixed-bar {
    position: fixed;
    bottom: 0; left:0; right:0;
    display: flex;
    gap: 10px;
    padding: 8px;
    background: linear-gradient(135deg,#1e3c72,#2a5298);
    box-shadow: 0 -2px 6px rgba(0,0,0,.1);
    z-index: 999;
  }
  .fixed-bar button {
    flex: 1;
    padding: 10px 0;
    font-size: 0.85rem;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    color: #fff;
  }
  .btn-wa { background: var(--success); }
  .btn-back { background: #d8cd33; color:#000; }

  /* ===================== FLOATING DARK TOGGLE ===================== */
  .dark-float {
    position: fixed;
    bottom: 100px;
    right: 20px;
    z-index: 1000;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--primary);
    color: #fff;
    font-size: 1.4rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: grab;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    user-select: none;
  }
  .dark-float:active {
    cursor: grabbing;
  }

  /* ===================== RESPONSIVE ===================== */
  @media (max-width: 500px) {
    header .header-inner { flex-direction: column; align-items: flex-start; gap: 6px; }
    header h1 { font-size: 1rem; }
    .room-card img { height: 80px; }
    .fixed-bar { flex-direction: column; gap: 6px; padding: 6px; }
    .fixed-bar button { width: 100%; padding: 10px 0; }
  }
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <img id="restoLogo" alt="Logo" />
    <div>
      <h1 id="restoName">Nama Restoran</h1>
      <div class="contact-info">
        <div id="alamatRestoranDisplay"></div>
        <div id="teleponRestoranDisplay"></div>
      </div>
    </div>
  </div>
</header>

<!-- Floating Dark Toggle -->
<button id="darkToggle" class="dark-float">üåô</button>

<div class="main-container" id="app">
  <!-- Tabs -->
  <div class="tabs">
    <button class="active" data-target="rooms">Rooms</button>
    <button data-target="meetings">Meeting Rooms</button>
    <button data-target="packages">Packages</button>
  </div>

  <!-- Grid -->
  <section id="rooms" class="grid"></section>
  <section id="meetings" class="grid hidden"></section>
  <section id="packages" class="grid hidden"></section>
  <p id="empty" class="hidden" style="text-align:center;color:#666;margin-top:8px">Belum ada data.</p>

  <!-- Cart + Form -->
  <div class="reservasi-container">
    <div id="cartPreview"><p><i>No choice</i></p></div>
    <p id="cartTotal">Total: 0</p>

    <div class="form-input"><label>Orderer Name</label><input type="text" id="custName"></div>
    <div class="form-input"><label>Address</label><input type="text" id="custAddress"></div>
    <div class="form-input"><label>Telephone Number</label><input type="text" id="custPhone"></div>
    <div class="form-input"><label>Date Used</label><input type="date" id="custDate"></div>
    <div class="form-input"><label>Notes</label><textarea id="custNote"></textarea></div>

    <!-- Bottom Buttons -->
    <div class="fixed-bar">
      <button class="btn-wa" id="btnSend">üì§ Send Request</button>
      <button class="btn-back" onclick="history.back()">üîô Back To Menu</button>
    </div>
  </div>
</div>

<script>
  // Dummy Data (buat testing)
  const restoData = {
    logo: "https://via.placeholder.com/60",
    namaRestoran: "Resto Mantap",
    restoAddress: "Jl. Contoh No.1",
    restoPhone: "08123456789",
    nomorWaAdmin: ["08123456789"],
    rooms: [
      {nama:"Room A", harga:200000, kapasitas:2, luas:12, deskripsi:"Double Bed", kategori:"hotel", image:"https://via.placeholder.com/150"},
      {nama:"Room B", harga:150000, kapasitas:1, luas:8, deskripsi:"Single Bed", kategori:"hotel", image:"https://via.placeholder.com/150"},
      {nama:"Meeting 1", harga:500000, kapasitas:10, luas:30, deskripsi:"Projector", kategori:"meeting", image:"https://via.placeholder.com/150"},
      {nama:"Paket VIP", harga:1000000, kapasitas:5, luas:20, deskripsi:"Full Service", kategori:"package", image:"https://via.placeholder.com/150"}
    ]
  };

  let cart = [];

  // ===================== DARK MODE FLOAT =====================
  function updateDarkIcon() {
    const btn = document.getElementById("darkToggle");
    btn.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
  }
  function toggleDark() {
    document.body.classList.toggle("dark");
    localStorage.setItem("menuva_theme", document.body.classList.contains("dark") ? "dark" : "light");
    updateDarkIcon();
  }
  function applyTheme() {
    if (localStorage.getItem("menuva_theme") === "dark") {
      document.body.classList.add("dark");
    }
    updateDarkIcon();
  }

  // Dragging floating button
  (function dragFloating() {
    const btn = document.getElementById("darkToggle");
    let offsetX, offsetY, dragging = false;

    btn.addEventListener("mousedown", startDrag);
    btn.addEventListener("touchstart", startDrag);

    function startDrag(e) {
      dragging = true;
      const rect = btn.getBoundingClientRect();
      offsetX = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
      offsetY = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
      document.addEventListener("mousemove", drag);
      document.addEventListener("mouseup", stopDrag);
      document.addEventListener("touchmove", drag);
      document.addEventListener("touchend", stopDrag);
    }

    function drag(e) {
      if (!dragging) return;
      e.preventDefault();
      let x = (e.touches ? e.touches[0].clientX : e.clientX) - offsetX;
      let y = (e.touches ? e.touches[0].clientY : e.clientY) - offsetY;
      btn.style.left = x + "px";
      btn.style.top = y + "px";
      btn.style.right = "auto";
      btn.style.bottom = "auto";
    }

    function stopDrag() {
      dragging = false;
      document.removeEventListener("mousemove", drag);
      document.removeEventListener("mouseup", stopDrag);
      document.removeEventListener("touchmove", drag);
      document.removeEventListener("touchend", stopDrag);
    }
  })();

  document.getElementById("darkToggle").addEventListener("click", toggleDark);

  // ===================== BUILD CARD =====================
  function buatCard(room) {
    return `
      <div class="room-card">
        <img src="${room.image}" alt="${room.nama}">
        <h3>${room.nama}</h3>
        <p><b>Price:</b> Rp ${room.harga.toLocaleString()}</p>
        <p><b>Capacity:</b> ${room.kapasitas} person</p>
        <p><b>Room size:</b> ${room.luas} m¬≤</p>
        <p>${room.deskripsi}</p>
        <button onclick='tambahKeCart(${JSON.stringify(room)})'>Add To Cart</button>
      </div>
    `;
  }

  // ===================== CART =====================
  function updateCart() {
    const preview = document.getElementById("cartPreview");
    const totalEl = document.getElementById("cartTotal");
    if(cart.length===0){
      preview.innerHTML = "<p><i>There are no selected items.</i></p>";
      totalEl.innerText = "Total: 0";
      return;
    }
    preview.innerHTML = "";
    let total = 0;
    cart.forEach((item, idx)=>{
      const subtotal = item.harga * item.qty;
      total += subtotal;
      const div = document.createElement("div");
      div.className = "cart-item";
      div.innerHTML = `<span>${item.nama} - Rp ${item.harga.toLocaleString()} x ${item.qty} = <b>${subtotal.toLocaleString()}</b></span>
        ${item.kategori==="package"?`<button onclick="ubahQty(${idx},-1)">-</button><button onclick="ubahQty(${idx},1)">+</button>`:""}
        <button onclick="hapusDariCart(${idx})">‚ùå</button>`;
      preview.appendChild(div);
    });
    totalEl.innerText = "Total: Rp "+total.toLocaleString();
  }

  function tambahKeCart(room){
    const idx = cart.findIndex(r=>r.nama===room.nama);
    if(idx>=0) cart[idx].qty++;
    else cart.push({...room, qty:1});
    updateCart();
  }
  function hapusDariCart(i){ cart.splice(i,1); updateCart(); }
  function ubahQty(i,d){ cart[i].qty+=d; if(cart[i].qty<1) cart[i].qty=1; updateCart(); }

  // ===================== DISPLAY DATA =====================
  function tampilkanData(){
    document.getElementById("restoLogo").src = restoData.logo;
    document.getElementById("restoName").innerText = restoData.namaRestoran;
    document.getElementById("alamatRestoranDisplay").innerText = restoData.restoAddress;
    document.getElementById("teleponRestoranDisplay").innerText = restoData.restoPhone;

    const grids = {rooms:document.getElementById("rooms"), meetings:document.getElementById("meetings"), packages:document.getElementById("packages")};
    Object.values(grids).forEach(g=>g.innerHTML="");

    let total=0;
    restoData.rooms.forEach(room=>{
      total++;
      if(room.kategori==="hotel") grids.rooms.innerHTML += buatCard(room);
      else if(room.kategori==="meeting") grids.meetings.innerHTML += buatCard(room);
      else if(room.kategori==="package") grids.packages.innerHTML += buatCard(room);
    });
    document.getElementById("empty").classList.toggle("hidden", total>0);
  }

  // ===================== TABS =====================
  function setupTabs(){
    document.querySelectorAll(".tabs button").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
        btn.classList.add("active");
        document.querySelectorAll(".grid").forEach(sec=>sec.classList.add("hidden"));
        document.getElementById(btn.dataset.target).classList.remove("hidden");
      });
    });
  }

  // ===================== WHATSAPP =====================
  function setupWA(){
    document.getElementById("btnSend").addEventListener("click", ()=>{
      if(!restoData.nomorWaAdmin || restoData.nomorWaAdmin.length===0){ alert("Admin's WhatsApp number has not been set."); return; }
      if(cart.length===0){ alert("Cart is still empty."); return; }

      const custName = document.getElementById("custName").value.trim();
      const custAddress = document.getElementById("custAddress").value.trim();
      const custPhone = document.getElementById("custPhone").value.trim();
      const custDate = document.getElementById("custDate").value.trim();
      const custNote = document.getElementById("custNote").value.trim();
      if(!custName || !custPhone || !custDate){ alert("Please fill in Name, Phone Number, and Date."); return; }

      let msg = `*Reservation Request*%0A--------------------%0A`;
      msg += `*Name:* ${custName}%0A*Address:* ${custAddress}%0A*Phone:* ${custPhone}%0A*Date:* ${custDate}%0A*Note:* ${custNote}%0A--------------------%0A`;

      let total=0;
      cart.forEach(item=>{
        const subtotal=item.harga*item.qty;
        total+=subtotal;
        msg+=`‚Ä¢ ${item.nama} x${item.qty} = Rp ${subtotal.toLocaleString()}%0A`;
      });
      msg+=`--------------------%0ATotal: Rp ${total.toLocaleString()}`;

      const url = `https://wa.me/${restoData.nomorWaAdmin[0]}?text=${msg}`;
      window.open(url,"_blank");
    });
  }

  // ===================== INIT =====================
  document.addEventListener("DOMContentLoaded", ()=>{
    applyTheme();
    tampilkanData();
    setupTabs();
    setupWA();
  });
</script>

</body>
</html>
