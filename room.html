<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reservasi Room</title>
  <style>
    /* ===== GENERAL STYLES ===== */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background: linear-gradient(to right,#2a5298,#1e3c72);
  color: #333;
}

/* ===== HEADER ===== */
header {
  text-align: center;
  padding: 25px 15px;
}
#restoLogo {
  max-height: 80px;
  margin-bottom: 10px;
}
#restoName {
  font-size: 28px;
  margin: 0;
  color: #f1f1f1;
  font-weight: 700;
  letter-spacing: 1px;
}
.contact-info p {
  margin: 2px 0;
  font-size: 14px;
  font-weight: 600;
  color: #e0e0e0;
}

/* ===== MAIN CONTAINER ===== */
.main-container {
  width: 95%;
  max-width: 1600px;
  margin: 20px auto 120px auto;
  padding: 25px;
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
  transition: transform 0.3s ease;
}
.main-container:hover {
  transform: translateY(-2px);
}

/* ===== TABS ===== */
.tabs {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 25px;
  flex-wrap: wrap;
}
.tabs button {
  padding: 10px 20px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  background: #f1f1f1;
  transition: all 0.3s ease;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}
.tabs button.active, .tabs button:hover {
  background: #007bff;
  color: #fff;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* ===== GRID ===== */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 20px;
}

/* ===== ROOM CARD ===== */
.room-card {
  border-radius: 16px;
  overflow: hidden;
  background: #fff;
  padding: 15px;
  text-align: center;
  box-shadow: 0 6px 18px rgba(0,0,0,0.15);
  transition: all 0.3s ease;
  position: relative;
}
.room-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 30px rgba(0,0,0,0.25);
}
.room-card img {
  max-width: 100%;
  border-radius: 12px;
  margin-bottom: 12px;
  transition: transform 0.3s ease;
}
.room-card img:hover {
  transform: scale(1.05);
}
.room-card h4 {
  font-size: 18px;
  margin: 8px 0 4px 0;
  font-weight: 700;
  color: #333;
}
.room-card p {
  font-size: 14px;
  color: #666;
  margin-bottom: 12px;
}
.room-card button {
  margin-top: 10px;
  background: #28a745;
  color: #fff;
  border: none;
  border-radius: 12px;
  padding: 10px 18px;
  cursor: pointer;
  font-size: 15px;
  font-weight: 600;
  transition: all 0.3s ease;
}
.room-card button:hover {
  background: #218838;
  transform: translateY(-2px);
}

/* ===== CART / RESERVASI ===== */
.reservasi-container {
  width: 95%;
  max-width: 1600px;
  margin: -90px auto 20px;
  padding: 20px 25px;
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}
.reservasi-container h3 { margin-top: 0; }

.cart-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 0;
  border-bottom: 1px solid #eee;
}
.cart-item span { flex: 1; text-align: left; font-weight: 500; }
.cart-item button {
  border: none;
  background: #dc3545;
  color: #fff;
  padding: 6px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 13px;
  margin-left: 5px;
  transition: all 0.3s ease;
}
.cart-item button:hover { background: #a71d2a; }

#cartTotal {
  font-weight: bold;
  text-align: right;
  margin-top: 12px;
  font-size: 16px;
}

/* ===== FORM INPUT ===== */
.form-input { margin-top: 15px; }
.form-input label {
  display: block;
  margin-bottom: 6px;
  font-weight: 600;
  color: #333;
}
.form-input input, .form-input textarea {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 10px;
  box-sizing: border-box;
  font-size: 14px;
  transition: border 0.3s ease, box-shadow 0.3s ease;
}
.form-input input:focus, .form-input textarea:focus {
  border-color: #007bff;
  box-shadow: 0 0 8px rgba(0,123,255,0.2);
  outline: none;
}

/* ===== BOTTOM BUTTONS ===== */
.bottom-buttons {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(to right,#2a5298,#1e3c72);
  padding: 12px;
  max-width: 1600px;
  width: 100%;
  display: flex;
  justify-content: center;
  gap: 12px;
  border-top: 1px solid #4423bb;
  flex-wrap: wrap;
}
.bottom-buttons button {
  flex: 1;
  max-width: 750px;
  padding: 14px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  transition: all 0.3s ease;
}
.bottom-buttons button:hover { transform: translateY(-2px); }
.btn-wa { background: #25d366; color: #fff; }
.btn-back { background: #d8cd33; color: #fff; }

/* ===== MOBILE RESPONSIVE ===== */
@media screen and (max-width: 768px) {
  body { font-size: 16px; }

  header { padding: 15px; }
  #restoName { font-size: 22px; }
  .contact-info p { font-size: 12px; }

  .main-container, .reservasi-container { padding: 15px; margin: 10px auto 80px auto; }

  .tabs button { padding: 8px 14px; font-size: 14px; }

  .grid { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px; }

  .room-card { padding: 12px; }
  .room-card button { padding: 10px; font-size: 14px; }

  .cart-item button { padding: 4px 8px; font-size: 12px; }

  .form-input input, .form-input textarea { padding: 8px; font-size: 14px; }

  .bottom-buttons {
    flex-direction: column;
    gap: 8px;
    padding: 8px;
  }
  .bottom-buttons button { max-width: 100%; }
}
/* ===== DARK MODE ===== */
body.dark-mode {
  background: #121212;
  color: #e0e0e0;
}

body.dark-mode .main-container,
body.dark-mode .reservasi-container,
body.dark-mode .room-card {
  background: #1e1e1e;
  box-shadow: 0 6px 20px rgba(0,0,0,0.5);
}

body.dark-mode header {
  color: #f1f1f1;
}

body.dark-mode .tabs button {
  background: #2a2a2a;
  color: #ccc;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
body.dark-mode .tabs button.active,
body.dark-mode .tabs button:hover {
  background: #007bff;
  color: #fff;
}

body.dark-mode .room-card button {
  background: #28a745;
  color: #fff;
}
body.dark-mode .room-card button:hover {
  background: #218838;
}

body.dark-mode .cart-item {
  border-bottom: 1px solid #333;
}
body.dark-mode .cart-item button {
  background: #dc3545;
}
body.dark-mode .cart-item button:hover {
  background: #a71d2a;
}

body.dark-mode .form-input input,
body.dark-mode .form-input textarea {
  background: #2a2a2a;
  color: #e0e0e0;
  border: 1px solid #444;
}
body.dark-mode .form-input input:focus,
body.dark-mode .form-input textarea:focus {
  border-color: #007bff;
  box-shadow: 0 0 8px rgba(0,123,255,0.3);
}

body.dark-mode .bottom-buttons {
  background: #1b1b1b;
  border-top: 1px solid #333;
}
  </style>
 
</head>
<body>
  <!-- HEADER LANGSUNG DI BODY -->
  <header>
    <img id="restoLogo" alt="Logo" />
    <h1 id="restoName"></h1>
    <div class="contact-info">
      <p id="alamatRestoranDisplay"></p>
      <p id="teleponRestoranDisplay"></p>
      <img id="restoLogo" src="logo.png" alt="Logo">
  <h1 id="restoName">Hotel Elegan</h1>
  <p class="contact-info">Kontak: 0812-3456-7890</p>
  <button id="darkModeToggle" style="margin-top:10px; padding:6px 12px; border:none; border-radius:8px; cursor:pointer;">🌙 Dark Mode</button>
    </div>
  </header>

  <div class="main-container" id="app">
    <div class="tabs">
      <button class="active" data-target="rooms">Rooms</button>
      <button data-target="meetings">Meeting Rooms</button>
      <button data-target="packages">Packages</button>
    </div>

    <section id="rooms" class="grid"></section>
    <section id="meetings" class="grid hidden"></section>
    <section id="packages" class="grid hidden"></section>
    <p id="empty" class="hidden" style="text-align:center;color:#666;margin-top:8px">Belum ada data.</p>
  </div>

  <!-- Preview Pesanan -->
  <div class="reservasi-container">
    <h3>Preview Pesanan</h3>
    <div id="cartPreview"><p><i>No choice</i></p></div>
    <p id="cartTotal">Total: 0</p>

    <div class="form-input">
      <label>Orderer Name</label>
      <input type="text" id="custName">
    </div>
    <div class="form-input">
      <label>Address</label>
      <input type="text" id="custAddress">
    </div>
    <div class="form-input">
      <label>Telephone Number</label>
      <input type="text" id="custPhone">
    </div>
    <div class="form-input">
      <label>Date Used</label>
      <input type="date" id="custDate">
    </div>
    <div class="form-input">
      <label>Notes</label>
      <textarea id="custNote"></textarea>
    </div>
  </div>

  <div class="bottom-buttons" id="bottomBar">
    <button class="btn-wa" id="btnSend">📤 Send Request</button>
    <button class="btn-back" onclick="history.back()">🔙 Back To Menu</button>
  </div>

<script>
  /* === DB dan fungsi sama kaya sebelumnya === */
  const DB_NAME = "MenuvaDB";
  const STORE_NAME = "menuvaData";
  const DB_VERSION = 1;

  let restoData = {};
  let cart = [];

  function openDB() {
    return new Promise((resolve, reject) => {
      const request = indexedDB.open(DB_NAME, DB_VERSION);
      request.onerror = () => reject("❌ Gagal buka DB");
      request.onsuccess = () => resolve(request.result);
    });
  }

  function loadDataFromDB() {
    return new Promise(async (resolve, reject) => {
      try {
        const db = await openDB();
        const tx = db.transaction(STORE_NAME, "readonly");
        const store = tx.objectStore(STORE_NAME);
        const request = store.get(1);
        request.onsuccess = () => resolve(request.result || {});
        request.onerror = () => reject("❌ Failed to retrieve data");
      } catch (e) { reject(e); }
    });
  }

  function buatCard(room) {
    return `
      <div class="room-card">
        <img src="${room.image || ""}" alt="${room.nama}">
        <h3>${room.nama}</h3>
        <p><b>Price:</b> ${room.harga.toLocaleString()}</p>
        <p><b>Capacity:</b> ${room.kapasitas} person</p>
        <p><b>Room size:</b> ${room.luas} m²</p>
        <p>${room.deskripsi}</p>
        <button onclick='tambahKeCart(${JSON.stringify(room)})'>Add To Chart</button>
      </div>
    `;
  }

  function updateCart() {
    const preview = document.getElementById("cartPreview");
    const totalEl = document.getElementById("cartTotal");
    if (cart.length === 0) {
      preview.innerHTML = "<p><i>There are no selected items.</i></p>";
      totalEl.innerText = "Total:  0";
      return;
    }
    let total = 0;
    preview.innerHTML = "";
    cart.forEach((item, idx) => {
      const subtotal = item.harga * item.qty;
      total += subtotal;
      const div = document.createElement("div");
      div.className = "cart-item";
      div.innerHTML = `
        <span>${item.nama} -  ${item.harga.toLocaleString()} x ${item.qty} = <b> ${subtotal.toLocaleString()}</b></span>
        ${item.kategori === "package" ? `
          <button onclick="ubahQty(${idx},-1)">-</button>
          <button onclick="ubahQty(${idx},1)">+</button>
        ` : ""}
        <button onclick="hapusDariCart(${idx})">❌</button>
      `;
      preview.appendChild(div);
    });
    totalEl.innerText = "Total:  " + total.toLocaleString();
  }

  function tambahKeCart(room) {
    const idx = cart.findIndex(r => r.nama === room.nama);
    if (idx >= 0) {
      cart[idx].qty++;
    } else {
      cart.push({ ...room, qty: 1 });
    }
    updateCart();
  }

  function hapusDariCart(index) {
    cart.splice(index,1);
    updateCart();
  }

  function ubahQty(index, delta) {
    cart[index].qty += delta;
    if (cart[index].qty < 1) cart[index].qty = 1;
    updateCart();
  }

  async function tampilkanData() {
    try {
      const data = await loadDataFromDB();
      restoData = data;

      document.getElementById("restoLogo").src = data.logo || "";
      document.getElementById("restoName").innerText = data.namaRestoran || "Nama Resto";
      document.getElementById("alamatRestoranDisplay").innerText = data.restoAddress || "";
      document.getElementById("teleponRestoranDisplay").innerText = data.restoPhone || "";

      ["rooms","meetings","packages"].forEach(id=>{
        document.getElementById(id).innerHTML="";
      });

      let total = 0;
      if (data.rooms && data.rooms.length > 0) {
        data.rooms.forEach(room=>{
          total++;
          if(room.kategori==="hotel"){
            document.getElementById("rooms").innerHTML += buatCard(room);
          } else if(room.kategori==="meeting"){
            document.getElementById("meetings").innerHTML += buatCard(room);
          } else if(room.kategori==="package"){
            document.getElementById("packages").innerHTML += buatCard(room);
          }
        });
      }
      document.getElementById("empty").classList.toggle("hidden", total>0);
    } catch(e){
      console.error("❌ Error:", e);
    }
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    document.querySelectorAll(".tabs button").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
        btn.classList.add("active");

        document.querySelectorAll("section").forEach(sec=>sec.classList.add("hidden"));
        document.getElementById(btn.dataset.target).classList.remove("hidden");
      });
    });

    document.getElementById("btnSend").addEventListener("click", ()=>{
      if(!restoData.nomorWaAdmin || restoData.nomorWaAdmin.length===0){
        alert("Admin's WhatsApp number has not been set.");
        return;
      }
      if(cart.length === 0){
        alert("Cart is still empty.");
        return;
      }

      const adminNo = restoData.nomorWaAdmin[0].replace(/[^0-9]/g,"");

      let pesan = `Hello ${restoData.namaRestoran || "Admin"}, I want a reservation:\n\n`;
      cart.forEach((item,i)=>{
        pesan += `${i+1}. ${item.nama} - Rp ${item.harga.toLocaleString()} x ${item.qty} = Rp ${(item.harga*item.qty).toLocaleString()}\n`;
      });
      let total = cart.reduce((a,b)=>a+(b.harga*b.qty),0);
      pesan += `\nTotal: Rp ${total.toLocaleString()}\n\n`;

      pesan += `Name: ${document.getElementById("custName").value}\n`;
      pesan += `Address: ${document.getElementById("custAddress").value}\n`;
      pesan += `Phone Number: ${document.getElementById("custPhone").value}\n`;
      pesan += `Date: ${document.getElementById("custDate").value}\n`;
      pesan += `Notes: ${document.getElementById("custNote").value}\n`;

      const url = `https://wa.me/${adminNo}?text=${encodeURIComponent(pesan)}`;
      window.open(url,"_blank");
    });

    tampilkanData();
  });
</script>
  <script>
  const toggle = document.getElementById('darkModeToggle');
  toggle.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
    if(document.body.classList.contains('dark-mode')){
      toggle.textContent = '☀️ Light Mode';
    } else {
      toggle.textContent = '🌙 Dark Mode';
    }
  });
</script>

</body>
</html>

